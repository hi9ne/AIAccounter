# üß™ –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é AI –§–∏–Ω–∞–Ω—Å–æ–≤–æ–≥–æ –ê—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞

## üìã –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é

### 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
```sql
-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Supabase
SELECT version();

-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ –æ—Å–Ω–æ–≤–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü
SELECT tablename FROM pg_tables WHERE schemaname = 'public';

-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏
SELECT routine_name FROM information_schema.routines 
WHERE routine_schema = 'public' AND routine_type = 'FUNCTION';
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ N8N
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ credentials –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã:
  - ‚úÖ Telegram Bot API
  - ‚úÖ OpenAI API
  - ‚úÖ PostgreSQL (Supabase)
- –ê–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ workflow `AnaliziFinance`

## üöÄ –¢–µ—Å—Ç–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ë–∞–∑–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
```
1. –û—Ç–ø—Ä–∞–≤–∏—Ç—å –≤ Telegram: "–ü–æ—Ç—Ä–∞—Ç–∏–ª 500 —Å–æ–º –Ω–∞ –ø—Ä–æ–¥—É–∫—Ç—ã"
   –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: ‚úÖ –†–∞—Å—Ö–æ–¥ –¥–æ–±–∞–≤–ª–µ–Ω + workspace_id

2. –û—Ç–ø—Ä–∞–≤–∏—Ç—å: "–ó–∞—Ä–∞–±–æ—Ç–∞–ª 50000 —Å–æ–º –∑–∞—Ä–ø–ª–∞—Ç–∞"
   –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: ‚úÖ –î–æ—Ö–æ–¥ –¥–æ–±–∞–≤–ª–µ–Ω

3. –û—Ç–ø—Ä–∞–≤–∏—Ç—å: "–ü–æ–∫–∞–∂–∏ —Ä–∞—Å—Ö–æ–¥—ã –∑–∞ –Ω–æ—è–±—Ä—å"
   –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: –°–ø–∏—Å–æ–∫ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π —Å –≤–∞–ª—é—Ç–∞–º–∏
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –†–∞–±–æ—Ç–∞ —Å –≤–∞–ª—é—Ç–∞–º–∏
```
1. "–ü–æ—Ç—Ä–∞—Ç–∏–ª $50 –Ω–∞ –∫–∞—Ñ–µ"
   –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ USD

2. "–ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–π 100 –¥–æ–ª–ª–∞—Ä–æ–≤ –≤ —Å–æ–º—ã"
   –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: –ê–∫—Ç—É–∞–ª—å–Ω—ã–π –∫—É—Ä—Å + —Å—É–º–º–∞ –≤ KGS

3. "–ö–∞–∫–æ–π –∫—É—Ä—Å –µ–≤—Ä–æ?"
   –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: –ö—É—Ä—Å—ã –≤–∞–ª—é—Ç —Å —ç–º–æ–¥–∑–∏
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ —Ñ—É–Ω–∫—Ü–∏–∏
```
1. "–ü–æ–∫–∞–∂–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∑–∞ –º–µ—Å—è—Ü"
   –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ get_income_expense_stats()

2. "–¢–æ–ø –∫–∞—Ç–µ–≥–æ—Ä–∏–π —Ä–∞—Å—Ö–æ–¥–æ–≤"
   –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ get_top_categories()

3. "–£—Å—Ç–∞–Ω–æ–≤–∏ –±—é–¥–∂–µ—Ç 30000 —Å–æ–º –Ω–∞ –Ω–æ—è–±—Ä—å"
   –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–∏ –≤ —Ç–∞–±–ª–∏—Ü–µ budgets
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 4: –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
```
1. "–ò–∑–º–µ–Ω–∏ –ø–æ—Å–ª–µ–¥–Ω–∏–π —Ä–∞—Å—Ö–æ–¥ –Ω–∞ 600 —Å–æ–º"
   –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ safe_update_transaction()

2. "–£–¥–∞–ª–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é –Ω–æ–º–µ—Ä 5"
   –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: Soft delete (deleted_at = NOW())

3. "–ü–æ–∫–∞–∂–∏ –∏—Å—Ç–æ—Ä–∏—é –∏–∑–º–µ–Ω–µ–Ω–∏–π –ø–æ—Å–ª–µ–¥–Ω–µ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏"
   –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: –î–∞–Ω–Ω—ã–µ –∏–∑ transaction_history
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 5: –ü–æ–¥–ø–∏—Å–∫–∏ –∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
```
1. "–î–æ–±–∞–≤—å –ø–æ–¥–ø–∏—Å–∫—É Netflix $12.99 –≤ –º–µ—Å—è—Ü"
   –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: –ó–∞–ø–∏—Å—å –≤ recurring_payments

2. "–ü–æ–∫–∞–∂–∏ –º–æ–∏ –ø–æ–¥–ø–∏—Å–∫–∏"
   –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: –ê–∫—Ç–∏–≤–Ω—ã–µ –ø–æ–¥–ø–∏—Å–∫–∏

3. "–û—Ç–º–µ–Ω–∏ –ø–æ–¥–ø–∏—Å–∫—É –Ω–æ–º–µ—Ä 1"
   –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: is_active = false
```

## üîç –ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è—Ç—å

### ‚úÖ –£—Å–ø–µ—à–Ω—ã–µ —Ç–µ—Å—Ç—ã –¥–æ–ª–∂–Ω—ã –ø–æ–∫–∞–∑–∞—Ç—å:
- –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ workspace_id
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã —Å –ø–æ–ª–Ω—ã–º –Ω–∞–±–æ—Ä–æ–º –ø–æ–ª–µ–π
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–π Supabase –≤–º–µ—Å—Ç–æ –ø—Ä—è–º—ã—Ö SQL
- –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç–æ–≤ —Å —ç–º–æ–¥–∑–∏
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ audit_logs

### ‚ùå –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏:
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ workspace_id –≤ –∑–∞–ø—Ä–æ—Å–∞—Ö
- –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö (—Å—Ç—Ä–æ–∫–∞ –≤–º–µ—Å—Ç–æ —á–∏—Å–ª–∞)
- –ü—Ä–æ–±–ª–µ–º—ã —Å —Ñ–æ—Ä–º–∞—Ç–æ–º –¥–∞—Ç
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∞–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### –ü–æ–ª–µ–∑–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏:
```sql
-- –ü–æ—Å–ª–µ–¥–Ω–∏–µ —Ä–∞—Å—Ö–æ–¥—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
SELECT e.*, w.name as workspace_name 
FROM expenses e 
JOIN workspaces w ON e.workspace_id = w.id 
WHERE e.user_id = YOUR_TELEGRAM_ID 
ORDER BY e.created_at DESC LIMIT 10;

-- –ü—Ä–æ–≤–µ—Ä–∫–∞ audit –ª–æ–≥–æ–≤
SELECT * FROM audit_logs 
WHERE user_id = YOUR_TELEGRAM_ID 
ORDER BY created_at DESC LIMIT 10;

-- –ê–∫—Ç–∏–≤–Ω—ã–µ workspace –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
SELECT * FROM get_user_workspaces(YOUR_TELEGRAM_ID);

-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞ —Ç–µ–∫—É—â–∏–π –º–µ—Å—è—Ü
SELECT * FROM get_income_expense_stats(
  (SELECT id FROM workspaces WHERE owner_id = YOUR_TELEGRAM_ID LIMIT 1),
  DATE_TRUNC('month', CURRENT_DATE)::DATE,
  CURRENT_DATE
);
```

## üéØ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ç–µ—Å—Ç—ã

### –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö:
```sql
-- –°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π workspace
INSERT INTO workspaces (name, owner_id, description, currency)
VALUES ('Test Workspace', YOUR_TELEGRAM_ID, 'For testing', 'KGS');

-- –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ –∫—É—Ä—Å—ã –≤–∞–ª—é—Ç
INSERT INTO exchange_rates (date, from_currency, to_currency, rate, source)
VALUES 
  (CURRENT_DATE, 'USD', 'KGS', 87.50, 'test'),
  (CURRENT_DATE, 'EUR', 'KGS', 95.20, 'test'),
  (CURRENT_DATE, 'RUB', 'KGS', 0.95, 'test');

-- –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π –±—é–¥–∂–µ—Ç
INSERT INTO budgets (user_id, workspace_id, month, budget_amount, currency)
VALUES (YOUR_TELEGRAM_ID, 1, TO_CHAR(CURRENT_DATE, 'YYYY-MM'), 50000, 'KGS');
```

## üì± Telegram —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### 1. –†—É—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:
- –ù–∞–π–¥–∏—Ç–µ –≤–∞—à–µ–≥–æ –±–æ—Ç–∞ –≤ Telegram
- –û—Ç–ø—Ä–∞–≤—å—Ç–µ –∫–æ–º–∞–Ω–¥—ã –∏–∑ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ –≤—ã—à–µ
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –æ—Ç–≤–µ—Ç—ã –∏ –ª–æ–≥–∏ –≤ N8N

### 2. –ù–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:
- –û—Ç–ø—Ä–∞–≤—å—Ç–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ –∫–æ–º–∞–Ω–¥ –ø–æ–¥—Ä—è–¥
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫
- –¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ –¥–ª–∏–Ω–Ω—ã–µ —Ç–µ–∫—Å—Ç—ã –∏ —ç–º–æ–¥–∑–∏

## üêõ Debug —Ä–µ–∂–∏–º

### –í N8N –≤–∫–ª—é—á–∏—Ç–µ –¥–µ—Ç–∞–ª—å–Ω—ã–µ –ª–æ–≥–∏:
1. –û—Ç–∫—Ä–æ–π—Ç–µ workflow
2. –ù–∞–∂–º–∏—Ç–µ "Execute Workflow"
3. –û—Ç–ø—Ä–∞–≤—å—Ç–µ —Ç–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–∞–∂–¥–æ–≥–æ —É–∑–ª–∞
5. –°–º–æ—Ç—Ä–∏—Ç–µ SQL –∑–∞–ø—Ä–æ—Å—ã –∏ –æ—Ç–≤–µ—Ç—ã

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫:
```sql
-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—à–∏–±–∫–∏
SELECT * FROM error_logs 
WHERE user_id = YOUR_TELEGRAM_ID 
ORDER BY timestamp DESC;
```

## üéâ –ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞

### ‚úÖ –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—à–ª–∏, –µ—Å–ª–∏:
- AI –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø–æ–Ω–∏–º–∞–µ—Ç –∫–æ–º–∞–Ω–¥—ã –Ω–∞ —Ä—É—Å—Å–∫–æ–º
- –í—Å–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è —Å workspace_id
- –§—É–Ω–∫—Ü–∏–∏ Supabase –≤—ã–∑—ã–≤–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- –ö—É—Ä—Å—ã –≤–∞–ª—é—Ç —Ä–∞–±–æ—Ç–∞—é—Ç
- –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–æ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∏ –∞–ª–µ—Ä—Ç—ã —Å—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç
- –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤–µ–¥–µ—Ç—Å—è
- –ü–æ–¥–ø–∏—Å–∫–∏ —É–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:
1. –õ–æ–≥–∏ N8N workflow
2. –õ–æ–≥–∏ Supabase 
3. Telegram webhook —Å—Ç–∞—Ç—É—Å
4. OpenAI API –ª–∏–º–∏—Ç—ã
5. –ü—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å credentials