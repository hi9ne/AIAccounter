# üîÑ Changelog - Telegram Mini App

## [2.1.0] - 30 –æ–∫—Ç—è–±—Ä—è 2025 - –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤–∞–ª—é—Ç

### üéØ –ì–ª–∞–≤–Ω–∞—è —Ñ–∏—á–∞: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤–∞–ª—é—Ç

#### üí± –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –º–µ–∂–¥—É KGS, USD, EUR, RUB
- ‚úÖ –ê–∫—Ç—É–∞–ª—å–Ω—ã–µ –∫—É—Ä—Å—ã –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –µ–∂–µ–¥–Ω–µ–≤–Ω–æ –≤ 10:00
- ‚úÖ –ö–æ–º–∞–Ω–¥—ã: "–ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–π 1000 —Å–æ–º –≤ –¥–æ–ª–ª–∞—Ä—ã", "–ö–∞–∫–æ–π –∫—É—Ä—Å –µ–≤—Ä–æ?"
- ‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤ –ª—é–±–æ–π –≤–∞–ª—é—Ç–µ: "–ü–æ–∫–∞–∂–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –≤ –¥–æ–ª–ª–∞—Ä–∞—Ö"
- ‚úÖ –ö—Ä–æ—Å—Å-–∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è: EUR‚ÜíRUB, USD‚ÜíEUR –∏ —Ç.–¥.

#### üóÑÔ∏è –ù–æ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö
```sql
-- –¢–∞–±–ª–∏—Ü–∞ –∫—É—Ä—Å–æ–≤ –≤–∞–ª—é—Ç
CREATE TABLE exchange_rates (
    id SERIAL PRIMARY KEY,
    date DATE NOT NULL,
    from_currency VARCHAR(3) NOT NULL,
    to_currency VARCHAR(3) NOT NULL,
    rate NUMERIC(10, 6) NOT NULL,
    source VARCHAR(50) DEFAULT 'exchangerate-api.com',
    UNIQUE(date, from_currency, to_currency)
);

-- –§—É–Ω–∫—Ü–∏—è –ø–æ–ª—É—á–µ–Ω–∏—è –∫—É—Ä—Å–∞
CREATE FUNCTION get_exchange_rate(
    p_from VARCHAR(3),
    p_to VARCHAR(3),
    p_date DATE DEFAULT CURRENT_DATE
) RETURNS NUMERIC;

-- –§—É–Ω–∫—Ü–∏—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏
CREATE FUNCTION convert_amount(
    p_amount NUMERIC,
    p_from VARCHAR(3),
    p_to VARCHAR(3),
    p_date DATE DEFAULT CURRENT_DATE
) RETURNS NUMERIC;

-- View –∞–∫—Ç—É–∞–ª—å–Ω—ã—Ö –∫—É—Ä—Å–æ–≤
CREATE VIEW v_latest_rates AS
SELECT * FROM exchange_rates 
WHERE date = (SELECT MAX(date) FROM exchange_rates);
```

#### ü§ñ –ù–æ–≤—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã AI Agent

**Convert_currency** (Postgres Tool)
```sql
-- –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è —Å—É–º–º—ã —Å –∞–∫—Ç—É–∞–ª—å–Ω—ã–º –∫—É—Ä—Å–æ–º
SELECT 
    {{ $fromAI("amount") }} as original_amount,
    UPPER('{{ $fromAI("from_currency") }}') as from_currency,
    UPPER('{{ $fromAI("to_currency") }}') as to_currency,
    get_exchange_rate(...) as rate,
    convert_amount(...) as converted_amount
```

**Get_exchange_rates** (Postgres Tool)
```sql
-- –ü—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö –∞–∫—Ç—É–∞–ª—å–Ω—ã—Ö –∫—É—Ä—Å–æ–≤
SELECT 
    from_currency,
    to_currency,
    rate,
    date
FROM v_latest_rates
ORDER BY from_currency, to_currency;
```

#### üîÑ –ù–æ–≤—ã–π workflow: ExchangeRates_Daily

**Cron Schedule:** –ï–∂–µ–¥–Ω–µ–≤–Ω–æ –≤ 10:00 (Asia/Bishkek)

**Workflow:**
1. HTTP Request ‚Üí ExchangeRate-API
2. JavaScript ‚Üí –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
3. Postgres ‚Üí INSERT —Å ON CONFLICT DO UPDATE
4. Telegram ‚Üí –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É

**–ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö:** https://api.exchangerate-api.com/v4/latest/KGS

**–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –ø–∞—Ä—ã:** 16+ –∫–æ–º–±–∏–Ω–∞—Ü–∏–π (KGS‚ÜîUSD, KGS‚ÜîEUR, KGS‚ÜîRUB, USD‚ÜîEUR –∏ —Ç.–¥.)

### üìä –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

#### –ö–æ–º–∞–Ω–¥—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
```
‚úÖ "–ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–π 1000 —Å–æ–º –≤ –¥–æ–ª–ª–∞—Ä—ã"
   ‚Üí üí± 1,000 KGS = 11.50 USD (–ø–æ –∫—É—Ä—Å—É 87.00)

‚úÖ "–ö–∞–∫–æ–π –∫—É—Ä—Å –µ–≤—Ä–æ?"
   ‚Üí üí± 1 EUR = 94.50 KGS

‚úÖ "–°–∫–æ–ª—å–∫–æ –±—É–¥–µ—Ç 100 –¥–æ–ª–ª–∞—Ä–æ–≤ –≤ —Å–æ–º–∞—Ö?"
   ‚Üí üí± 100 USD = 8,700 KGS

‚úÖ "–ü–µ—Ä–µ–≤–µ–¥–∏ 50 –µ–≤—Ä–æ –≤ —Ä—É–±–ª–∏"
   ‚Üí üí± 50 EUR = 5,225 RUB (–ø–æ –∫—É—Ä—Å—É 104.50)

‚úÖ "–ü–æ–∫–∞–∂–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –≤ –¥–æ–ª–ª–∞—Ä–∞—Ö"
   ‚Üí üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞ –æ–∫—Ç—è–±—Ä—å 2025 (–≤ USD):
      üí∏ –†–∞—Å—Ö–æ–¥—ã: 316.23 USD
      üí∞ –î–æ—Ö–æ–¥—ã: 1,179.46 USD
      üìà –ü—Ä–∏–±—ã–ª—å: 863.23 USD

‚úÖ "–í—Å–µ –∫—É—Ä—Å—ã"
   ‚Üí üí± –ê–∫—Ç—É–∞–ª—å–Ω—ã–µ –∫—É—Ä—Å—ã –Ω–∞ 30.10.2025:
      KGS ‚Üí USD: 0.0115
      USD ‚Üí KGS: 87.00
      ...
```

### üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

#### –ú–∏–≥—Ä–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
```bash
# –§–∞–π–ª: migrations/add_exchange_rates.sql
- –¢–∞–±–ª–∏—Ü–∞ exchange_rates (6 –ø–æ–ª–µ–π)
- –§—É–Ω–∫—Ü–∏–∏ get_exchange_rate() –∏ convert_amount()
- View v_latest_rates –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞
- –¢—Ä–∏–≥–≥–µ—Ä auto_create_reverse_rate (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ–±—Ä–∞—Ç–Ω—ã–µ –∫—É—Ä—Å—ã)
- –ù–∞—á–∞–ª—å–Ω—ã–µ –∫—É—Ä—Å—ã (12+ –∑–∞–ø–∏—Å–µ–π)
```

#### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ AI Agent
```javascript
// AnaliziFinance.json
+ Convert_currency (Postgres Tool)
+ Get_exchange_rates (Postgres Tool)
+ –û–±–Ω–æ–≤–ª—ë–Ω System Message —Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏
+ –î–æ–±–∞–≤–ª–µ–Ω—ã ai_tool connections
```

### üìö –ù–æ–≤–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- ‚ûï `docs/CURRENCY_CONVERSION.md` - —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- ‚ûï `ROADMAP_v2.1.md` - –ø–ª–∞–Ω —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
- ‚ûï `UPGRADE_TO_2.1.md` - –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å v2.0
- ‚ûï `migrations/add_exchange_rates.sql` - SQL –º–∏–≥—Ä–∞—Ü–∏—è

### üêõ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ: –æ—à–∏–±–∫–∏ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞ psql –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ (–∑–∞–º–µ–Ω–µ–Ω—ã –Ω–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π SQL)
- –£–ª—É—á—à–µ–Ω–æ: –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ API –∫—É—Ä—Å–æ–≤
- –£–ª—É—á—à–µ–Ω–æ: –≤–∞–ª–∏–¥–∞—Ü–∏—è –≤–∞–ª—é—Ç –ø–µ—Ä–µ–¥ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–µ–π

### ‚ö° –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

- View `v_latest_rates` –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ –∞–∫—Ç—É–∞–ª—å–Ω—ã–º –∫—É—Ä—Å–∞–º
- –ò–Ω–¥–µ–∫—Å—ã –Ω–∞ (date, from_currency, to_currency) –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∫—É—Ä—Å–æ–≤ –≤ –ë–î (–Ω–µ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º API –∫–∞–∂–¥—ã–π —Ä–∞–∑)

### üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- ON CONFLICT DO UPDATE –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –¥—É–±–ª–∏–∫–∞—Ç—ã
- –í–∞–ª–∏–¥–∞—Ü–∏—è –≤–∞–ª—é—Ç —á–µ—Ä–µ–∑ CHECK constraints
- Rate limiting –¥–ª—è API –∑–∞–ø—Ä–æ—Å–æ–≤ (1 —Ä–∞–∑ –≤ –¥–µ–Ω—å)

### üìä –ú–∏–≥—Ä–∞—Ü–∏—è —Å v2.0

**–í—Ä–µ–º—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:** ~20 –º–∏–Ω—É—Ç

**–®–∞–≥–∏:**
1. –í—ã–ø–æ–ª–Ω–∏—Ç–µ `migrations/add_exchange_rates.sql` –≤ Supabase
2. –ò–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ `ExchangeRates_Daily.json` –≤ n8n
3. –û–±–Ω–æ–≤–∏—Ç–µ `AnaliziFinance.json` –≤ n8n
4. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ 6 –∫–æ–º–∞–Ω–¥ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏

**–ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏:** –°–º. `UPGRADE_TO_2.1.md`

### ‚úÖ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

**–°—Ç–∞—Ç—É—Å:** –ì–æ—Ç–æ–≤ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é

**Test Suite:**
- [ ] –¢–µ—Å—Ç 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫—É—Ä—Å–æ–≤ ("–ö–∞–∫–æ–π –∫—É—Ä—Å –¥–æ–ª–ª–∞—Ä–∞?")
- [ ] –¢–µ—Å—Ç 2: –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è ("–ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–π 1000 —Å–æ–º –≤ –¥–æ–ª–ª–∞—Ä—ã")
- [ ] –¢–µ—Å—Ç 3: –û–±—Ä–∞—Ç–Ω–∞—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è ("100 –¥–æ–ª–ª–∞—Ä–æ–≤ –≤ —Å–æ–º—ã")
- [ ] –¢–µ—Å—Ç 4: –ö—Ä–æ—Å—Å-–∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è ("50 –µ–≤—Ä–æ –≤ —Ä—É–±–ª–∏")
- [ ] –¢–µ—Å—Ç 5: –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤ –≤–∞–ª—é—Ç–µ ("–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤ –¥–æ–ª–ª–∞—Ä–∞—Ö")
- [ ] –¢–µ—Å—Ç 6: –í—Å–µ –∫—É—Ä—Å—ã ("–í—Å–µ –∫—É—Ä—Å—ã")

---

## [2.0.0] - 28 —è–Ω–≤–∞—Ä—è 2025 - –ú—É–ª—å—Ç–∏–≤–∞–ª—é—Ç–Ω–æ—Å—Ç—å –∏ —É–ª—É—á—à–µ–Ω–∏—è

### ‚ú® –ù–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

#### –ú—É–ª—å—Ç–∏–≤–∞–ª—é—Ç–Ω–æ—Å—Ç—å
- üí± –ü–æ–¥–¥–µ—Ä–∂–∫–∞ 4 –≤–∞–ª—é—Ç: KGS (—Å–æ–º), USD, EUR, RUB
- üè¶ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å–∏–º–≤–æ–ª–∞ –≤–∞–ª—é—Ç—ã
- üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å —É—á—ë—Ç–æ–º –≤–∞–ª—é—Ç—ã
- üìã –ò—Å—Ç–æ—Ä–∏—è —Å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º –≤–∞–ª—é—Ç—ã –∫–∞–∂–¥–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏

#### –£–ª—É—á—à–µ–Ω–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
- ‚ûï –î–æ–±–∞–≤–ª–µ–Ω–æ 6 –Ω–æ–≤—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π —Ä–∞—Å—Ö–æ–¥–æ–≤:
  - –ö–∞—Ñ–µ –∏ —Ä–µ—Å—Ç–æ—Ä–∞–Ω—ã
  - –ú–µ–¥–∏—Ü–∏–Ω–∞
  - –û–¥–µ–∂–¥–∞
  - –†–∞–∑–≤–ª–µ—á–µ–Ω–∏—è
  - –•–æ–∑—è–π—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã
  - –û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ
  - –ë–ª–∞–≥–æ—Ç–≤–æ—Ä–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
  
- ‚ûï –î–æ–±–∞–≤–ª–µ–Ω–æ 2 –Ω–æ–≤—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –¥–æ—Ö–æ–¥–æ–≤:
  - –§—Ä–∏–ª–∞–Ω—Å
  - –ê—Ä–µ–Ω–¥–∞ –∏–º—É—â–µ—Å—Ç–≤–∞

#### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
- üîó –ü—Ä—è–º–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Supabase (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- ü§ñ –†–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã —á–µ—Ä–µ–∑ Telegram Bot (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–µ–∫

#### UI/UX —É–ª—É—á—à–µ–Ω–∏—è
- üì± –£–ª—É—á—à–µ–Ω–Ω—ã–π –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–π –¥–∏–∑–∞–π–Ω
- üåô –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ç–µ–º–Ω–æ–π —Ç–µ–º—ã Telegram
- üìÖ –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–∞—Ç—ã –≤ –∏—Å—Ç–æ—Ä–∏–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
- üí´ –ê–Ω–∏–º–∞—Ü–∏–∏ –∏ –ø–ª–∞–≤–Ω—ã–µ –ø–µ—Ä–µ—Ö–æ–¥—ã
- ‚úÖ –ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —Å —Å–∏–º–≤–æ–ª–æ–º –≤–∞–ª—é—Ç—ã

### üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

#### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
```javascript
// –ù–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
{
    type: 'income' | 'expense',
    amount: number,
    currency: 'KGS' | 'USD' | 'EUR' | 'RUB',
    category: string,
    description: string,
    date: string,
    time: string,
    telegram_user_id: number
}
```

#### –ù–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
- `updateCurrencyDisplay()` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤–∞–ª—é—Ç—ã
- `sendToSupabase()` - –ø—Ä—è–º–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ –≤ Supabase
- `resetForm()` - —Å–±—Ä–æ—Å —Ñ–æ—Ä–º—ã —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –¥–µ—Ñ–æ–ª—Ç–Ω–æ–π –≤–∞–ª—é—Ç—ã

#### API –∏–∑–º–µ–Ω–µ–Ω–∏—è
```javascript
// –î–ª—è —Ä–µ–∂–∏–º–∞ Supabase
POST /rest/v1/expenses
POST /rest/v1/income

Headers:
- apikey: SUPABASE_ANON_KEY
- Authorization: Bearer SUPABASE_ANON_KEY
- Content-Type: application/json

Body:
{
    "amount": 1000,
    "currency": "KGS",
    "category": "–ü—Ä–æ–¥—É–∫—Ç—ã",
    "description": "–ü–æ–∫—É–ø–∫–∞ –≤ —Å—É–ø–µ—Ä–º–∞—Ä–∫–µ—Ç–µ",
    "date": "2025-01-28T14:30:00",
    "telegram_user_id": 123456789
}
```

### üóÉÔ∏è –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

#### –¢—Ä–µ–±—É–µ–º–∞—è –º–∏–≥—Ä–∞—Ü–∏—è
```sql
-- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—è currency
ALTER TABLE expenses ADD COLUMN IF NOT EXISTS currency VARCHAR(3) DEFAULT 'KGS' NOT NULL;
ALTER TABLE income ADD COLUMN IF NOT EXISTS currency VARCHAR(3) DEFAULT 'KGS' NOT NULL;

-- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è
ALTER TABLE expenses ADD CONSTRAINT expenses_currency_check 
CHECK (currency IN ('KGS', 'USD', 'EUR', 'RUB'));

ALTER TABLE income ADD CONSTRAINT income_currency_check 
CHECK (currency IN ('KGS', 'USD', 'EUR', 'RUB'));

-- –ò–Ω–¥–µ–∫—Å—ã –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
CREATE INDEX IF NOT EXISTS idx_expenses_currency ON expenses(currency);
CREATE INDEX IF NOT EXISTS idx_income_currency ON income(currency);
```

### üìù –ú–∏–≥—Ä–∞—Ü–∏—è —Å –≤–µ—Ä—Å–∏–∏ 1.x

1. **–û–±–Ω–æ–≤–∏—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö:**
```bash
# –í—ã–ø–æ–ª–Ω–∏—Ç–µ SQL –∏–∑ migrations/add_currency_field.sql
psql -h your-supabase-host -U postgres -d postgres -f migrations/add_currency_field.sql
```

2. **–û–±–Ω–æ–≤–∏—Ç–µ n8n workflow:**
- –ò–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –æ–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–π `AnaliziFinance.json`
- –ò–ª–∏ –æ–±–Ω–æ–≤–∏—Ç–µ –≤—Ä—É—á–Ω—É—é Add_expense –∏ Add_income –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã

3. **–û–±–Ω–æ–≤–∏—Ç–µ Mini App:**
- –ó–∞–º–µ–Ω–∏—Ç–µ `TelegramMiniApp.html` –Ω–∞ –Ω–æ–≤—É—é –≤–µ—Ä—Å–∏—é
- –°–æ–∑–¥–∞–π—Ç–µ `miniapp-config.js` –∏–∑ `miniapp-config.example.js`
- –ó–∞–≥—Ä—É–∑–∏—Ç–µ –Ω–∞ —Ö–æ—Å—Ç–∏–Ω–≥

4. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å:**
```javascript
// –°—Ç–∞—Ä—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –±–µ–∑ currency –±—É–¥—É—Ç –∏–º–µ—Ç—å 'KGS' –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
SELECT * FROM expenses WHERE currency IS NULL;
-- –î–æ–ª–∂–Ω–æ –±—ã—Ç—å –ø—É—Å—Ç–æ –ø–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏
```

### üêõ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ: —Ñ–æ—Ä–º–∞ –Ω–µ –æ—á–∏—â–∞–ª–∞—Å—å –ø–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ: –∫–∞—Ç–µ–≥–æ—Ä–∏—è –Ω–µ —Å–±—Ä–∞—Å—ã–≤–∞–ª–∞—Å—å
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ: –≤—Ä–µ–º—è –Ω–µ –æ–±–Ω–æ–≤–ª—è–ª–æ—Å—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ: —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–∫–∞–∑—ã–≤–∞–ª–∞ ‚ÇΩ –≤–º–µ—Å—Ç–æ –≤—ã–±—Ä–∞–Ω–Ω–æ–π –≤–∞–ª—é—Ç—ã
- –£–ª—É—á—à–µ–Ω–æ: –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –¥–∞–Ω–Ω—ã—Ö
- –£–ª—É—á—à–µ–Ω–æ: –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø—É—Å—Ç–æ–π –∏—Å—Ç–æ—Ä–∏–∏

### ‚ö° –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è: –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π
- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è: —É–º–µ–Ω—å—à–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ HTML (—Å–∂–∞—Ç–∏–µ CSS)
- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è: lazy loading –¥–ª—è –∏—Å—Ç–æ—Ä–∏–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π

### üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ telegram_user_id
- –£–ª—É—á—à–µ–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –∑–∞—â–∏—Ç–∞ –æ—Ç SQL –∏–Ω—ä–µ–∫—Ü–∏–π (—á–µ—Ä–µ–∑ Supabase RLS)

### üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- ‚ûï –î–æ–±–∞–≤–ª–µ–Ω `MINIAPP_SETUP.md` - –ø–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ
- ‚ûï –î–æ–±–∞–≤–ª–µ–Ω `miniapp-config.example.js` - –ø—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- ‚ûï –î–æ–±–∞–≤–ª–µ–Ω `CHANGELOG.md` - —ç—Ç–æ—Ç —Ñ–∞–π–ª
- üîÑ –û–±–Ω–æ–≤–ª—ë–Ω `README.md` - —É–ø–æ–º–∏–Ω–∞–Ω–∏–µ –º—É–ª—å—Ç–∏–≤–∞–ª—é—Ç–Ω–æ—Å—Ç–∏

---

## [1.0.0] - –ü–µ—Ä–≤—ã–π —Ä–µ–ª–∏–∑

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –¥–æ—Ö–æ–¥–æ–≤/—Ä–∞—Å—Ö–æ–¥–æ–≤
- –í—ã–±–æ—Ä –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
- –ì–æ–ª–æ—Å–æ–≤–æ–π –≤–≤–æ–¥
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- –ò—Å—Ç–æ—Ä–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Telegram Bot

---

## üîÆ –ü–ª–∞–Ω—ã –Ω–∞ –±—É–¥—É—â–µ–µ (v2.2+)

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã v2.2
- [ ] –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
- [ ] –£–¥–∞–ª–µ–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π (soft delete)
- [ ] –ì—Ä–∞—Ñ–∏–∫–∏ —Ä–∞—Å—Ö–æ–¥–æ–≤ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
- [ ] –ë—é–¥–∂–µ—Ç—ã –ø–æ –≤–∞–ª—é—Ç–∞–º —Å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏
- [ ] –ü—Ä–æ–≥–Ω–æ–∑ –∫—É—Ä—Å–æ–≤ –≤–∞–ª—é—Ç (ML)

### –í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ
- [ ] PDF –æ—Ç—á—ë—Ç—ã —Å –±—Ä–µ–Ω–¥–∏–Ω–≥–æ–º
- [ ] Recurring transactions (–ø–æ–¥–ø–∏—Å–∫–∏)
- [ ] –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Å—á–µ—Ç–∞ (–∫–æ—à–µ–ª—å–∫–∏)
- [ ] –¢—ë–º–Ω–∞—è —Ç–µ–º–∞ (–∫–∞—Å—Ç–æ–º–Ω–∞—è)
- [ ] –í–∏–¥–∂–µ—Ç—ã –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞

### –ò–¥–µ–∏
- [ ] –ì–µ–æ–ª–æ–∫–∞—Ü–∏—è –¥–ª—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
- [ ] QR-—Å–∫–∞–Ω–µ—Ä —á–µ–∫–æ–≤
- [ ] OCR –¥–ª—è —á–µ–∫–æ–≤
- [ ] –ò–º–ø–æ—Ä—Ç –±–∞–Ω–∫–æ–≤—Å–∫–∏—Ö –≤—ã–ø–∏—Å–æ–∫
- [ ] –≠–∫—Å–ø–æ—Ä—Ç –≤ 1C
- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å CRM
- [ ] –ú—É–ª—å—Ç–∏–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π —Ä–µ–∂–∏–º (—Å–µ–º—å—è/–∫–æ–º–∞–Ω–¥–∞)
- [ ] –¶–µ–ª–∏ –Ω–∞–∫–æ–ø–ª–µ–Ω–∏–π
- [ ] –ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω—ã–π –ø–æ—Ä—Ç—Ñ–µ–ª—å
- [ ] –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö –∫—É—Ä—Å–∞ –≤–∞–ª—é—Ç

---

**üìÖ –ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 30 –æ–∫—Ç—è–±—Ä—è 2025  
**üè∑Ô∏è –¢–µ–∫—É—â–∞—è –≤–µ—Ä—Å–∏—è:** 2.1.0  
**üë®‚Äçüíª –ê–≤—Ç–æ—Ä:** AI Accounter Team
