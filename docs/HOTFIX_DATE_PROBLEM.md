# ÐšÐ Ð˜Ð¢Ð˜Ð§Ð•Ð¡ÐšÐžÐ• Ð˜Ð¡ÐŸÐ ÐÐ’Ð›Ð•ÐÐ˜Ð•: ÐŸÑ€Ð¾Ð±Ð»ÐµÐ¼Ð° Ñ Ð´Ð°Ñ‚Ð°Ð¼Ð¸ Ñ‚Ñ€Ð°Ð½Ð·Ð°ÐºÑ†Ð¸Ð¹

## ðŸ”´ ÐÐ°Ð¹Ð´ÐµÐ½Ð½Ð°Ñ Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼Ð°

Ð’ÑÐµ Ñ‚Ñ€Ð°Ð½Ð·Ð°ÐºÑ†Ð¸Ð¸ Ð² Ð±Ð°Ð·Ðµ Ð´Ð°Ð½Ð½Ñ‹Ñ… ÑÐ¾Ñ…Ñ€Ð°Ð½ÑÐ»Ð¸ÑÑŒ Ñ Ð´Ð°Ñ‚Ð¾Ð¹ **`0001-01-01 BC`** (1 Ð³Ð¾Ð´ Ð´Ð¾ Ð½Ð°ÑˆÐµÐ¹ ÑÑ€Ñ‹) Ð²Ð¼ÐµÑÑ‚Ð¾ Ñ‚ÐµÐºÑƒÑ‰ÐµÐ¹ Ð´Ð°Ñ‚Ñ‹. Ð­Ñ‚Ð¾ Ð¾Ð±ÑŠÑÑÐ½ÑÐµÑ‚, Ð¿Ð¾Ñ‡ÐµÐ¼Ñƒ Ð½ÐµÐ´ÐµÐ»ÑŒÐ½Ñ‹Ðµ Ð¾Ñ‚Ñ‡ÐµÑ‚Ñ‹ Ð¿Ð¾ÐºÐ°Ð·Ñ‹Ð²Ð°Ð»Ð¸ 0 â‚¸ - SQL-Ð·Ð°Ð¿Ñ€Ð¾ÑÑ‹ Ð½Ðµ Ð½Ð°Ñ…Ð¾Ð´Ð¸Ð»Ð¸ Ñ‚Ñ€Ð°Ð½Ð·Ð°ÐºÑ†Ð¸Ð¸ Ð² Ð´Ð¸Ð°Ð¿Ð°Ð·Ð¾Ð½Ðµ Ð¿Ð¾ÑÐ»ÐµÐ´Ð½Ð¸Ñ… 7 Ð´Ð½ÐµÐ¹.

### ÐŸÑ€Ð¸Ñ‡Ð¸Ð½Ð°
Ð’ workflow ÑƒÐ·Ð»Ñ‹ **Add_expense** Ð¸ **Add_income** Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð»Ð¸ `TO_DATE('', 'DD.MM.YYYY')` ÐºÐ¾Ð³Ð´Ð° AI Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°Ð» Ð¿ÑƒÑÑ‚ÑƒÑŽ ÑÑ‚Ñ€Ð¾ÐºÑƒ Ð´Ð»Ñ Ð´Ð°Ñ‚Ñ‹. PostgreSQL Ð½Ðµ Ð¼Ð¾Ð¶ÐµÑ‚ Ð¿Ñ€ÐµÐ¾Ð±Ñ€Ð°Ð·Ð¾Ð²Ð°Ñ‚ÑŒ Ð¿ÑƒÑÑ‚ÑƒÑŽ ÑÑ‚Ñ€Ð¾ÐºÑƒ Ð¸ Ð·Ð°Ð¿Ð¸ÑÑ‹Ð²Ð°Ð» `0001-01-01 BC`.

## âœ… Ð˜ÑÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ñ

### 1. Workflow Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ñ (AnaliziFinance.json)

#### Add_expense (ÑÑ‚Ñ€Ð¾ÐºÐ° ~516)
**Ð‘Ñ‹Ð»Ð¾:**
```sql
COALESCE(
  TO_DATE('{{ $fromAI("date", ...) }}', 'DD.MM.YYYY'),
  CURRENT_DATE
)
```

**Ð¡Ñ‚Ð°Ð»Ð¾:**
```sql
CASE 
  WHEN '{{ $fromAI("date", ...) }}' = '' THEN CURRENT_DATE
  ELSE TO_DATE('{{ $fromAI("date", ...) }}', 'DD.MM.YYYY')
END
```

#### Add_income (ÑÑ‚Ñ€Ð¾ÐºÐ° ~474)
ÐÐ½Ð°Ð»Ð¾Ð³Ð¸Ñ‡Ð½Ð¾Ðµ Ð¸ÑÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ð¿Ñ€Ð¸Ð¼ÐµÐ½ÐµÐ½Ð¾.

#### Get Weekly Data (ÑÑ‚Ñ€Ð¾ÐºÐ° ~1360)
Ð”Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ñ‹ ÑÐ²Ð½Ñ‹Ðµ Ð¿Ñ€Ð¸Ð²ÐµÐ´ÐµÐ½Ð¸Ñ Ðº DATE Ð¸ Ð²ÐµÑ€Ñ…Ð½ÑÑ Ð³Ñ€Ð°Ð½Ð¸Ñ†Ð°:
```sql
-- Ð‘Ñ‹Ð»Ð¾:
AND date >= CURRENT_DATE - INTERVAL '7 days'

-- Ð¡Ñ‚Ð°Ð»Ð¾:
AND DATE(date) >= CURRENT_DATE - INTERVAL '7 days'
AND DATE(date) <= CURRENT_DATE
```

## ðŸ“‹ Ð§Ñ‚Ð¾ Ð½ÑƒÐ¶Ð½Ð¾ ÑÐ´ÐµÐ»Ð°Ñ‚ÑŒ Ð¡Ð ÐžÐ§ÐÐž

### Ð¨Ð°Ð³ 1: ÐžÐ±Ð½Ð¾Ð²Ð¸Ñ‚ÑŒ workflow
1. Ð˜Ð¼Ð¿Ð¾Ñ€Ñ‚Ð¸Ñ€ÑƒÐ¹Ñ‚Ðµ Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð½Ñ‹Ð¹ `AnaliziFinance.json` Ð² n8n
2. ÐÐºÑ‚Ð¸Ð²Ð¸Ñ€ÑƒÐ¹Ñ‚Ðµ workflow

### Ð¨Ð°Ð³ 2: Ð˜ÑÐ¿Ñ€Ð°Ð²Ð¸Ñ‚ÑŒ ÑÑƒÑ‰ÐµÑÑ‚Ð²ÑƒÑŽÑ‰Ð¸Ðµ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð² Ð‘Ð”
1. ÐžÑ‚ÐºÑ€Ð¾Ð¹Ñ‚Ðµ Supabase â†’ SQL Editor
2. Ð¡ÐºÐ¾Ð¿Ð¸Ñ€ÑƒÐ¹Ñ‚Ðµ ÑÐ¾Ð´ÐµÑ€Ð¶Ð¸Ð¼Ð¾Ðµ Ñ„Ð°Ð¹Ð»Ð° `fix_broken_dates.sql`
3. Ð’Ñ‹Ð¿Ð¾Ð»Ð½Ð¸Ñ‚Ðµ Ð²ÐµÑÑŒ ÑÐºÑ€Ð¸Ð¿Ñ‚

**Ð¡ÐºÑ€Ð¸Ð¿Ñ‚ Ð²Ñ‹Ð¿Ð¾Ð»Ð½Ð¸Ñ‚:**
- âœ… ÐŸÐ¾Ð´ÑÑ‡Ð¸Ñ‚Ð°ÐµÑ‚ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ ÑÐ»Ð¾Ð¼Ð°Ð½Ð½Ñ‹Ñ… Ð·Ð°Ð¿Ð¸ÑÐµÐ¹
- âœ… ÐžÐ±Ð½Ð¾Ð²Ð¸Ñ‚ Ð²ÑÐµ Ð·Ð°Ð¿Ð¸ÑÐ¸ Ñ Ð´Ð°Ñ‚Ð¾Ð¹ `0001-01-01 BC` Ð½Ð° `CURRENT_DATE`
- âœ… ÐŸÑ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚ Ð´Ð»Ñ expenses Ð¸ income
- âœ… ÐŸÐ¾ÐºÐ°Ð¶ÐµÑ‚ Ð¸Ñ‚Ð¾Ð³Ð¾Ð²Ñ‹Ðµ Ñ‚Ñ€Ð°Ð½Ð·Ð°ÐºÑ†Ð¸Ð¸ Ð·Ð° Ð¿Ð¾ÑÐ»ÐµÐ´Ð½Ð¸Ðµ 7 Ð´Ð½ÐµÐ¹

### Ð¨Ð°Ð³ 3: ÐŸÑ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ Ñ€Ð°Ð±Ð¾Ñ‚Ñƒ
ÐŸÐ¾ÑÐ»Ðµ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ñ SQL-ÑÐºÑ€Ð¸Ð¿Ñ‚Ð° Ð¿Ñ€Ð¾Ñ‚ÐµÑÑ‚Ð¸Ñ€ÑƒÐ¹Ñ‚Ðµ Ð² Telegram:

```
ÐžÑ‚Ñ‡ÐµÑ‚ Ð·Ð° Ð½ÐµÐ´ÐµÐ»ÑŽ
```

Ð”Ð¾Ð»Ð¶ÐµÐ½ Ð¿Ð¾ÐºÐ°Ð·Ð°Ñ‚ÑŒ Ð²ÑÐµ Ð²Ð°ÑˆÐ¸ Ñ‚Ñ€Ð°Ð½Ð·Ð°ÐºÑ†Ð¸Ð¸:
- 500 ÑÐ¾Ð¼ - Ð¿Ñ€Ð¾Ð´ÑƒÐºÑ‚Ñ‹
- 50 ÑÐ¾Ð¼ - ÐºÐ°Ñ„Ðµ/Ñ€ÐµÑÑ‚Ð¾Ñ€Ð°Ð½Ñ‹
- 100 ÑÐ¾Ð¼ - Ð¿Ñ€Ð¾Ñ‡Ð½Ñ‹Ðµ
- 45000 ÑÐ¾Ð¼ - Ð¿Ñ€Ð¾Ñ‡ÐµÐµ (Ñ‚ÐµÐ»ÐµÑ„Ð¾Ð½)
- 1200 ÑÐ¾Ð¼ - Ñ‚Ñ€Ð°Ð½ÑÐ¿Ð¾Ñ€Ñ‚
- 25 ÑÐ¾Ð¼ - ÐºÐ°Ñ„Ðµ/Ñ€ÐµÑÑ‚Ð¾Ñ€Ð°Ð½Ñ‹
- 500 ÑÐ¾Ð¼ - Ð¿Ñ€Ð¾Ð´ÑƒÐºÑ‚Ñ‹

**Ð˜Ñ‚Ð¾Ð³Ð¾: ~47,375 ÑÐ¾Ð¼** (Ð¼Ð¸Ð½ÑƒÑ ÑƒÐ´Ð°Ð»ÐµÐ½Ð½Ð°Ñ Ð·Ð°Ð¿Ð¸ÑÑŒ 800 ÑÐ¾Ð¼)

### Ð¨Ð°Ð³ 4: Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ Ð½Ð¾Ð²ÑƒÑŽ Ñ‚Ñ€Ð°Ð½Ð·Ð°ÐºÑ†Ð¸ÑŽ Ð´Ð»Ñ Ñ‚ÐµÑÑ‚Ð°
ÐŸÐ¾ÑÐ»Ðµ Ð¸ÑÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ñ Ð´Ð¾Ð±Ð°Ð²ÑŒÑ‚Ðµ Ð½Ð¾Ð²Ñ‹Ð¹ Ñ€Ð°ÑÑ…Ð¾Ð´:
```
1000 Ð½Ð° Ñ‚ÐµÑÑ‚
```

Ð‘Ð¾Ñ‚ Ð´Ð¾Ð»Ð¶ÐµÐ½ Ð¾Ñ‚Ð²ÐµÑ‚Ð¸Ñ‚ÑŒ:
```
âœ… Ð Ð°ÑÑ…Ð¾Ð´ Ð´Ð¾Ð±Ð°Ð²Ð»ÐµÐ½: 1000 ÑÐ¾Ð¼ Ð½Ð° 'Ñ‚ÐµÑÑ‚' (05.11.2025)
```

Ð—Ð°Ñ‚ÐµÐ¼ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ:
```
Ð•Ð¶ÐµÐ´Ð½ÐµÐ²Ð½Ñ‹Ð¹ Ð¾Ñ‚Ñ‡ÐµÑ‚
```

Ð”Ð¾Ð»Ð¶ÐµÐ½ Ð¿Ð¾ÐºÐ°Ð·Ð°Ñ‚ÑŒ Ñ‚Ñ€Ð°Ð½Ð·Ð°ÐºÑ†Ð¸ÑŽ Ð¾Ñ‚ ÑÐµÐ³Ð¾Ð´Ð½Ñ (05.11.2025).

## ðŸŽ¯ ÐžÐ¶Ð¸Ð´Ð°ÐµÐ¼Ñ‹Ð¹ Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚

ÐŸÐ¾ÑÐ»Ðµ Ð²ÑÐµÑ… Ð¸ÑÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ð¹:
- âœ… ÐÐ¾Ð²Ñ‹Ðµ Ñ‚Ñ€Ð°Ð½Ð·Ð°ÐºÑ†Ð¸Ð¸ ÑÐ¾Ñ…Ñ€Ð°Ð½ÑÑŽÑ‚ÑÑ Ñ Ð¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ð¾Ð¹ Ð´Ð°Ñ‚Ð¾Ð¹
- âœ… Ð¡Ñ‚Ð°Ñ€Ñ‹Ðµ Ñ‚Ñ€Ð°Ð½Ð·Ð°ÐºÑ†Ð¸Ð¸ Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ñ‹ Ð½Ð° Ñ‚ÐµÐºÑƒÑ‰ÑƒÑŽ Ð´Ð°Ñ‚Ñƒ
- âœ… ÐÐµÐ´ÐµÐ»ÑŒÐ½Ñ‹Ð¹ Ð¾Ñ‚Ñ‡ÐµÑ‚ Ð¿Ð¾ÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÑ‚ Ð²ÑÐµ Ñ‚Ñ€Ð°Ð½Ð·Ð°ÐºÑ†Ð¸Ð¸
- âœ… Ð•Ð¶ÐµÐ´Ð½ÐµÐ²Ð½Ñ‹Ð¹ Ð¾Ñ‚Ñ‡ÐµÑ‚ Ð¿Ð¾ÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÑ‚ Ñ‚Ñ€Ð°Ð½Ð·Ð°ÐºÑ†Ð¸Ð¸ Ð·Ð° ÑÐµÐ³Ð¾Ð´Ð½Ñ
- âœ… ÐœÐµÑÑÑ‡Ð½Ñ‹Ð¹ Ð¾Ñ‚Ñ‡ÐµÑ‚ Ð±ÑƒÐ´ÐµÑ‚ Ñ€Ð°Ð±Ð¾Ñ‚Ð°Ñ‚ÑŒ ÐºÐ¾Ñ€Ñ€ÐµÐºÑ‚Ð½Ð¾

## ðŸ“ Ð”Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð°Ñ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ

**Ð’Ð°ÑˆÐ¸ Ð´Ð°Ð½Ð½Ñ‹Ðµ:**
- `user_id`: 1109421300
- `workspace_id`: 1
- Ð¡ÐµÑ€Ð²ÐµÑ€ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ UTC: 2025-11-04 21:02:11+00
- Ð’ÑÐµ Ñ‚Ñ€Ð°Ð½Ð·Ð°ÐºÑ†Ð¸Ð¸ Ð¸Ð¼ÐµÑŽÑ‚ `deleted_at IS NULL` (ÐºÑ€Ð¾Ð¼Ðµ id=6 Ñ 800 ÑÐ¾Ð¼)

**Ð¤Ð°Ð¹Ð»Ñ‹ Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ñ‹:**
- `AnaliziFinance.json` - Ð¸ÑÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ñ‹ Add_expense, Add_income, Get Weekly Data
- `fix_broken_dates.sql` - SQL-ÑÐºÑ€Ð¸Ð¿Ñ‚ Ð´Ð»Ñ Ð¸ÑÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ñ ÑÑƒÑ‰ÐµÑÑ‚Ð²ÑƒÑŽÑ‰Ð¸Ñ… Ð´Ð°Ð½Ð½Ñ‹Ñ…
- `debug_check_expenses.sql` - Ð´Ð¸Ð°Ð³Ð½Ð¾ÑÑ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ð¹ ÑÐºÑ€Ð¸Ð¿Ñ‚ Ð´Ð»Ñ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ¸

## âš ï¸ Ð’Ð°Ð¶Ð½Ð¾

**ÐÐ• Ð£Ð”ÐÐ›Ð¯Ð™Ð¢Ð•** ÑÑƒÑ‰ÐµÑÑ‚Ð²ÑƒÑŽÑ‰Ð¸Ðµ Ñ‚Ñ€Ð°Ð½Ð·Ð°ÐºÑ†Ð¸Ð¸ Ð²Ñ€ÑƒÑ‡Ð½ÑƒÑŽ! SQL-ÑÐºÑ€Ð¸Ð¿Ñ‚ `fix_broken_dates.sql` Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸ Ð¸ÑÐ¿Ñ€Ð°Ð²Ð¸Ñ‚ Ð²ÑÐµ Ð´Ð°Ñ‚Ñ‹ Ð¾Ð´Ð½Ð¾Ð¹ ÐºÐ¾Ð¼Ð°Ð½Ð´Ð¾Ð¹.
