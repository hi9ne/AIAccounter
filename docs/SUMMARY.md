# ‚úÖ AIAccounter Backend - –ó–∞–≤–µ—Ä—à–µ–Ω–æ

**–î–∞—Ç–∞:** 12 –Ω–æ—è–±—Ä—è 2025  
**–°—Ç–∞—Ç—É—Å:** –í—Å–µ TODO –∑–∞–¥–∞—á–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã

---

## üéØ –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ

### 1. JWT –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è ‚úÖ
**–§–∞–π–ª—ã:**
- `app/api/v1/auth.py` - Telegram –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
- `app/utils/auth.py` - JWT —É—Ç–∏–ª–∏—Ç—ã
- `app/schemas/auth.py` - Pydantic —Å—Ö–µ–º—ã

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ Telegram Mini App
- HTTP Bearer —Ç–æ–∫–µ–Ω—ã
- –¢–æ–∫–µ–Ω—ã –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã 30 –º–∏–Ω—É—Ç
- Dependency `get_current_user()` –¥–ª—è –≤—Å–µ—Ö –∑–∞—â–∏—â—ë–Ω–Ω—ã—Ö —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤

### 2. –ú–æ–¥–µ–ª–∏ SQLAlchemy ‚úÖ
**–§–∞–π–ª:** `app/models/models.py`

**–î–æ–±–∞–≤–ª–µ–Ω–æ 7 –Ω–æ–≤—ã—Ö –º–æ–¥–µ–ª–µ–π:**
- `Notification` - —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- `RecurringPayment` - —Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ –ø–ª–∞—Ç–µ–∂–∏/–ø–æ–¥–ø–∏—Å–∫–∏
- `OnboardingState` - –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –æ–Ω–±–æ—Ä–¥–∏–Ω–≥–∞
- `AuditLog` - –∂—É—Ä–Ω–∞–ª –∞—É–¥–∏—Ç–∞ –≤—Å–µ—Ö –¥–µ–π—Å—Ç–≤–∏–π
- `AnalyticsCache` - –∫–µ—à –∞–Ω–∞–ª–∏—Ç–∏–∫–∏
- `UserPreferences` - –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `WorkspaceInvite` - –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è –≤ workspace (—É–∂–µ –±—ã–ª)

### 3. User Profile API ‚úÖ
**–§–∞–π–ª:** `app/api/v1/users.py`

**–≠–Ω–¥–ø–æ–∏–Ω—Ç—ã:**
- `GET /api/v1/users/me` - –ø—Ä–æ—Ñ–∏–ª—å —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `PUT /api/v1/users/me` - –æ–±–Ω–æ–≤–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å
- `GET /api/v1/users/me/stats` - –¥–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

**–ò—Å–ø–æ–ª—å–∑—É–µ—Ç:** PostgreSQL —Ñ—É–Ω–∫—Ü–∏—é `get_user_profile()`

### 4. Workspaces API ‚úÖ
**–§–∞–π–ª—ã:**
- `app/api/v1/workspaces.py`
- `app/schemas/workspace.py`

**–≠–Ω–¥–ø–æ–∏–Ω—Ç—ã (13 —à—Ç—É–∫):**

**CRUD:**
- `POST /` - —Å–æ–∑–¥–∞—Ç—å workspace
- `GET /` - —Å–ø–∏—Å–æ–∫ workspaces
- `GET /{id}` - –¥–µ—Ç–∞–ª–∏ workspace
- `PUT /{id}` - –æ–±–Ω–æ–≤–∏—Ç—å workspace
- `DELETE /{id}` - —É–¥–∞–ª–∏—Ç—å workspace

**–£—á–∞—Å—Ç–Ω–∏–∫–∏:**
- `GET /{id}/members` - —Å–ø–∏—Å–æ–∫ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
- `DELETE /{id}/members/{user_id}` - —É–¥–∞–ª–∏—Ç—å —É—á–∞—Å—Ç–Ω–∏–∫–∞

**–ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è:**
- `POST /{id}/invites` - —Å–æ–∑–¥–∞—Ç—å –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ
- `POST /{id}/invites/{invite_id}/accept` - –ø—Ä–∏–Ω—è—Ç—å –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ
- `GET /invites/pending` - –º–æ–∏ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è

**–ò—Å–ø–æ–ª—å–∑—É–µ—Ç PostgreSQL —Ñ—É–Ω–∫—Ü–∏–∏:**
- `create_workspace_with_owner()`
- `get_user_workspaces()`
- `check_workspace_permission()`
- `accept_workspace_invite()`
- `remove_workspace_member()`

### 5. Categories API ‚úÖ
**–§–∞–π–ª:** `app/api/v1/categories.py`

**–≠–Ω–¥–ø–æ–∏–Ω—Ç—ã:**
- `GET /api/v1/categories/expenses` - 35 –∫–∞—Ç–µ–≥–æ—Ä–∏–π —Ä–∞—Å—Ö–æ–¥–æ–≤
- `GET /api/v1/categories/income` - 15 –∫–∞—Ç–µ–≥–æ—Ä–∏–π –¥–æ—Ö–æ–¥–æ–≤
- `GET /api/v1/categories/currencies` - 5 –≤–∞–ª—é—Ç
- `GET /api/v1/categories/all` - –≤—Å—ë –≤–º–µ—Å—Ç–µ

**–î–∞–Ω–Ω—ã–µ:** –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Å–ø–∏—Å–∫–∏ —Å —ç–º–æ–¥–∑–∏

### 6. Exchange Rates API ‚úÖ
**–§–∞–π–ª—ã:**
- `app/api/v1/rates.py`
- `app/schemas/rate.py`

**–≠–Ω–¥–ø–æ–∏–Ω—Ç—ã:**
- `GET /latest` - –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –∫—É—Ä—Å—ã
- `GET /history` - –∏—Å—Ç–æ—Ä–∏—è –∫—É—Ä—Å–æ–≤
- `GET /{from}/{to}` - –∫—É—Ä—Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –ø–∞—Ä—ã
- `POST /convert` - –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤–∞–ª—é—Ç—ã
- `POST /` - –¥–æ–±–∞–≤–∏—Ç—å –∫—É—Ä—Å
- `GET /currencies/supported` - —Å–ø–∏—Å–æ–∫ –≤–∞–ª—é—Ç

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –æ–±—Ä–∞—Ç–Ω—ã–π –∫—É—Ä—Å

### 7. Analytics API ‚úÖ
**–§–∞–π–ª—ã:**
- `app/api/v1/analytics.py`
- `app/schemas/analytics.py`

**–≠–Ω–¥–ø–æ–∏–Ω—Ç—ã (8 —à—Ç—É–∫):**
- `GET /stats` - –±–∞–∑–æ–≤–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- `GET /categories/top` - —Ç–æ–ø –∫–∞—Ç–µ–≥–æ—Ä–∏–π
- `GET /chart/balance-trend` - —Ç—Ä–µ–Ω–¥ –±–∞–ª–∞–Ω—Å–∞
- `GET /chart/income-expense` - –≥—Ä–∞—Ñ–∏–∫ –¥–æ—Ö–æ–¥–æ–≤/—Ä–∞—Å—Ö–æ–¥–æ–≤
- `GET /chart/category-pie` - –∫—Ä—É–≥–æ–≤–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞
- `GET /patterns` - –ø–∞—Ç—Ç–µ—Ä–Ω—ã —Ç—Ä–∞—Ç
- `GET /dashboard` - –≤—Å—ë –¥–ª—è –¥–∞—à–±–æ—Ä–¥–∞
- `GET /compare-periods` - —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–µ—Ä–∏–æ–¥–æ–≤

**–ò—Å–ø–æ–ª—å–∑—É–µ—Ç PostgreSQL —Ñ—É–Ω–∫—Ü–∏–∏:**
- `get_income_expense_stats()`
- `get_top_categories()`
- `get_balance_trend()`
- `get_income_expense_chart_data()`
- `get_category_pie_chart_data()`
- `get_spending_patterns()`

### 8. Reports API ‚úÖ
**–§–∞–π–ª—ã:**
- `app/api/v1/reports.py`
- `app/schemas/report.py`

**–≠–Ω–¥–ø–æ–∏–Ω—Ç—ã:**
- `POST /weekly` - –Ω–µ–¥–µ–ª—å–Ω—ã–π PDF –æ—Ç—á—ë—Ç
- `POST /monthly` - –º–µ—Å—è—á–Ω—ã–π PDF –æ—Ç—á—ë—Ç + –±—é–¥–∂–µ—Ç—ã
- `POST /period` - –æ—Ç—á—ë—Ç –∑–∞ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–π –ø–µ—Ä–∏–æ–¥
- `GET /history` - –∏—Å—Ç–æ—Ä–∏—è –æ—Ç—á—ë—Ç–æ–≤ (coming soon)

**–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è:** APITemplate.io  
**–®–∞–±–ª–æ–Ω—ã:** –í –ø–∞–ø–∫–µ `pdf-templates/`

### 9. –û–±–Ω–æ–≤–ª–µ–Ω—ã —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ API ‚úÖ
**–§–∞–π–ª—ã:**
- `app/api/v1/expenses.py` - –≤—Å–µ 6 —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤
- `app/api/v1/income.py` - –≤—Å–µ 5 —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤
- `app/api/v1/budget.py` - –≤—Å–µ 5 —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤

**–ò–∑–º–µ–Ω–µ–Ω–∏–µ:** –ó–∞–º–µ–Ω–∏–ª–∏ `user_id: int` –Ω–∞ `current_user: User = Depends(get_current_user)`

---

## üìä –ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

### –§–∞–π–ª—ã
- **–°–æ–∑–¥–∞–Ω–æ –Ω–æ–≤—ã—Ö:** 14 —Ñ–∞–π–ª–æ–≤
- **–û–±–Ω–æ–≤–ª–µ–Ω–æ:** 6 —Ñ–∞–π–ª–æ–≤
- **–û–±—â–∏–π —Ä–∞–∑–º–µ—Ä –∫–æ–¥–∞:** ~3500 —Å—Ç—Ä–æ–∫

### API Endpoints
- **–í—Å–µ–≥–æ –≥—Ä—É–ø–ø:** 10
- **–í—Å–µ–≥–æ —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤:** 65+
- **–° –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π:** 63
- **–ü—É–±–ª–∏—á–Ω—ã—Ö:** 2 (/auth/telegram, /docs)

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞
```
backend/
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ api/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ v1/
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ __init__.py ‚úÖ (–æ–±–Ω–æ–≤–ª—ë–Ω)
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ auth.py ‚úÖ (—Å–æ–∑–¥–∞–Ω)
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ users.py ‚úÖ (—Å–æ–∑–¥–∞–Ω)
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ categories.py ‚úÖ (—Å–æ–∑–¥–∞–Ω)
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ workspaces.py ‚úÖ (—Å–æ–∑–¥–∞–Ω)
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ rates.py ‚úÖ (—Å–æ–∑–¥–∞–Ω)
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ analytics.py ‚úÖ (—Å–æ–∑–¥–∞–Ω)
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ reports.py ‚úÖ (—Å–æ–∑–¥–∞–Ω)
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ expenses.py ‚úÖ (–æ–±–Ω–æ–≤–ª—ë–Ω)
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ income.py ‚úÖ (–æ–±–Ω–æ–≤–ª—ë–Ω)
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ budget.py ‚úÖ (–æ–±–Ω–æ–≤–ª—ë–Ω)
‚îÇ   ‚îú‚îÄ‚îÄ schemas/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth.py ‚úÖ (—Å–æ–∑–¥–∞–Ω)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ workspace.py ‚úÖ (—Å–æ–∑–¥–∞–Ω)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ rate.py ‚úÖ (—Å–æ–∑–¥–∞–Ω)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ analytics.py ‚úÖ (—Å–æ–∑–¥–∞–Ω)
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ report.py ‚úÖ (—Å–æ–∑–¥–∞–Ω)
‚îÇ   ‚îú‚îÄ‚îÄ models/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ models.py ‚úÖ (–æ–±–Ω–æ–≤–ª—ë–Ω +7 –º–æ–¥–µ–ª–µ–π)
‚îÇ   ‚îî‚îÄ‚îÄ utils/
‚îÇ       ‚îî‚îÄ‚îÄ auth.py ‚úÖ (—Å–æ–∑–¥–∞–Ω)
‚îú‚îÄ‚îÄ .env.example ‚úÖ (–æ–±–Ω–æ–≤–ª—ë–Ω)
‚îú‚îÄ‚îÄ requirements.txt ‚úÖ (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π, –≤—Å—ë –µ—Å—Ç—å)
‚îú‚îÄ‚îÄ API_COMPLETE.md ‚úÖ (—Å–æ–∑–¥–∞–Ω)
‚îú‚îÄ‚îÄ QUICKSTART.md ‚úÖ (—Å–æ–∑–¥–∞–Ω)
‚îî‚îÄ‚îÄ SUMMARY.md ‚úÖ (—ç—Ç–æ—Ç —Ñ–∞–π–ª)
```

---

## üöÄ –ì–æ—Ç–æ–≤–æ –∫ –∑–∞–ø—É—Å–∫—É

### –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å:
‚úÖ –í—Å–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã —Å–æ–∑–¥–∞–Ω—ã  
‚úÖ –í—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã  
‚úÖ Swagger –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –≥–æ—Ç–æ–≤–∞  
‚úÖ JWT –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞  
‚úÖ PostgreSQL —Ñ—É–Ω–∫—Ü–∏–∏ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω—ã  

### –¢—Ä–µ–±—É–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:
‚öôÔ∏è –§–∞–π–ª `.env` (—Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∏–∑ .env.example)  
‚öôÔ∏è SECRET_KEY –¥–ª—è production  
‚öôÔ∏è APITemplate.io –∫–ª—é—á–∏ –¥–ª—è PDF (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)  

### –ó–∞–ø—É—Å–∫:
```powershell
cd backend
.\venv\Scripts\activate
uvicorn app.main:app --reload
```

**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** http://localhost:8000/docs

---

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- **API_COMPLETE.md** - –ø–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –≤—Å–µ—Ö —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤
- **QUICKSTART.md** - –±—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç –∏ –ø—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤
- **TELEGRAM_AUTH.md** - –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Telegram Mini App
- **DATABASE_STRUCTURE.md** - —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ë–î –∏ —Ñ—É–Ω–∫—Ü–∏–∏

---

## üéâ –†–µ–∑—É–ª—å—Ç–∞—Ç

**–í—Å–µ TODO –∑–∞–¥–∞—á–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã:**

- [x] JWT –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- [x] –î–æ–ø–æ–ª–Ω–∏—Ç—å –º–æ–¥–µ–ª–∏ SQLAlchemy
- [x] User Profile API
- [x] Workspaces API
- [x] Categories API
- [x] Exchange Rates API
- [x] Analytics API
- [x] Reports API

**Backend –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!**

---

**–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫:** GitHub Copilot  
**–ü—Ä–æ–µ–∫—Ç:** AIAccounter v2.5  
**–î–∞—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è:** 12 –Ω–æ—è–±—Ä—è 2025
